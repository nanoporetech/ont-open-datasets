{"componentChunkName":"component---src-templates-blog-post-js","path":"/gm24385_2020.11_sv/","result":{"data":{"site":{"siteMetadata":{"title":"Oxford Nanopore Technologies Open Datasets"}},"markdownRemark":{"id":"48dbf188-c7a4-5fdb-9477-3547660dea73","excerpt":"In this blog post we will explore structural variant calling using the\nrecently released HG002 (GM24385 Ashkenazi Son) data\nrelease. The GM24385 dataset…","html":"<p>In this blog post we will explore structural variant calling using the\n<a href=\"/ont-open-datasets/gm24385_2020.11\">recently released</a> HG002 (GM24385 Ashkenazi Son) data\nrelease.</p>\n<p>The GM24385 dataset comprises whole genome sequencing of a well-characterised\nhuman cell line. It therefore provides a useful benchmark sample; the cell line\nwas also used as a “seen” sample in the recent\n<a href=\"PrecisionFDA%20Truth%0AChallenge%20V2\">https://precision.fda.gov/challenges/10/view/results</a> competition for small variant calling.</p>\n<h3>Structural variant calling with lra and cuteSV</h3>\n<p>As an easily reproducible example we will focus on a single flowcell of the\nGM24385 2020.11 data release.</p>\n<blockquote>\n<p><em>This walkthrough assumes some familiarity with standard bioinformatic tools\nfor handling genomics data. A working installation of\n<a href=\"http://www.htslib.org/\">samtools</a>,\n<a href=\"https://snakemake.readthedocs.io/en/stable/\">snakemake</a>,\n<a href=\"https://git-scm.com/\">git</a>, and the <a href=\"https://aws.amazon.com/cli/\">AWS command-line\ntools</a> are required to follow the process\nbelow.</em></p>\n</blockquote>\n<h4>Data preparation</h4>\n<p>We will start by downloading Guppy 4.0.11 basecalls from a PromethION\nsequencing experiment (see our <a href=\"/ont-open-datasets/tutorials\">tutorial</a> FAQs) for more\ninformation on downloading data):</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">aws s3 --no-sign-request cp \\\n    s3://ont-open-data/gm24385_2020.11/analysis/r9.4.1/20201026_1644_2-E5-H5_PAG07162_d7f262d5/guppy_v4.0.11_r9.4.1_hac_prom/basecalls.fastq.gz \\\n    basecalls.fastq.gz</code></pre></div>\n<p>The <code class=\"language-text\">.fastq</code> file downloaded above contains the QC pass calls from the experiment\namounting to around 200 Gbases.</p>\n<p>To run the SV calling pipeline and perform benchmarking we will need release 37\nof the human reference sequence:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">wget http://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/reference/human_g1k_v37.fasta.gz</code></pre></div>\n<h4>Running the variant calling</h4>\n<p>To perform structural variant calling Oxford Nanopore Technologies recommends\nusing the\n<a href=\"https://github.com/nanoporetech/pipeline-structural-variation\">pipeline-structural-variation</a>\nsnakemake workflow.  This workflow as been recently updated to use\n<a href=\"https://github.com/ChaissonLab/LRA\">lra</a> and\n<a href=\"https://github.com/tjiangHIT/cuteSV\">cuteSV</a>, replacing the previous\n<a href=\"https://github.com/lh3/minimap2\">minimap2</a> and\n<a href=\"https://github.com/fritzsedlazeck/Sniffles\">sniffles</a> based approach. After\ninstallation of this software we use it with its default settings:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">conda activate pipeline-structural-variation-v2\nsnakemake call --config \\\n    input_fastq=basecalls.fastq.gz \\\n    reference_fasta=human_g1k_v37.fasta \\\n    threads=76 \\\n    sample_name=PAG07162-hg37</code></pre></div>\n<p>The useful output for our purposes is the single Variant Call Format file; a copy\nof the file is available in the dataset S3 bucket at:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">s3://ont-open-data/gm24385_2020.11/extra_analyses/PAG07162-hg37/sv_calls/PAG07162-hg37_cutesv_filtered.vcf.gz</code></pre></div>\n<h3>Evaluation</h3>\n<p>The veracity of the variant calling performed above can be obtained by\ncomparing the results to the <a href=\"https://www.nist.gov/programs-projects/genome-bottle\">Genome In A\nBottle</a> truth sets for\nthe GM24385 sample. The truth sets can be downloaded from the\n<a href=\"https://www.ncbi.nlm.nih.gov/\">NCBI</a> repository:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">truth_name=&quot;HG002_SVs_Tier1_v0.6&quot;\nfor ext in &quot;.vcf.gz&quot;, &quot;.vcf.gz.tbi&quot;, &quot;.bed&quot;; do\n    wget -O $truth_name$ext \\\n        https://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/data/AshkenazimTrio/analysis/NIST_SVs_Integration_v0.6/$truth_name$ext\ndone</code></pre></div>\n<p>With these reference data we will use\n<a href=\"https://github.com/spiralgenetics/truvari\">truvari</a> to assess the recall and precision\nof the variant calls made by the calling pipeline:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">truth_vcf=&quot;${truth_name}.vcf.gz&quot;\ntruth_bed=&quot;${truth_name}.bed&quot;\nreference=&quot;human_g1k_v37.fasta&quot;\ninput_vcf=&quot;PAG07162-hg37_cutesv_filtered.vcf.gz&quot;\noutput_dir=&quot;truvari&quot;\ntruvari bench --passonly --pctsim 0 \\\n    -b $truth_vcf --includebed $truth_bed \\\n    -f $reference -c $input_vcf \\\n    -o $output_dir</code></pre></div>\n<p>Truvari outputs precision and recall figures for the structural variants.  With\na little work (detailed in the <a href=\"https://epi2me-labs.github.io/\">EPI2MELabs Structural Variation\nBenchmarking</a> tutorial) we can separate the\ncounts for deletion and insertion (including duplication) variants:</p>\n<table>\n<thead>\n<tr>\n<th>Type</th>\n<th>Deletions</th>\n<th>Insertions</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Recall</td>\n<td>0.9667</td>\n<td>0.9427</td>\n</tr>\n<tr>\n<td>Precision</td>\n<td>0.9893</td>\n<td>0.9667</td>\n</tr>\n<tr>\n<td>f1-score</td>\n<td>0.9779</td>\n<td>0.9545</td>\n</tr>\n</tbody>\n</table>\n<p>With still a little more work we can produce the following depicting the\nf1-score alongwith counts of SVs in the truthset:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 575px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/ont-open-datasets/static/f00bf98e186472966218d2ca1be133f2/59415/sv_f1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.05405405405405%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABq0lEQVQoz2WSS0/DMBCE85f5Uxw5ceaOCheEOAGiTdqkeT+a5mE7w84mKQUsWbHj9efZ2fWmaUKe52jrGhhHuL7HNAy/pq0bNEmOqW3n8zWu6+BOJ0Bi2qqCMQYegWVZopQfHM45nZZfOeO5MRZ+VMDJo85aOAFaQvkAhciohTEIWIFJkigUC2AdXDtnFb7LWhjdu8s5lfEB3qhEUCNqvaIoNOVqUdhLKr7vIwgCdLLmMNbhxS8wilKOVpQxJpQYI0qxAM/nMzyq46wX6aMEHI9HxHGscNGJfrTYfKYK5r4T7xiTpKk8YvRe0zTKUCAVrsBfKeveySWHx48ZOF2nfBVPhbTNo8wsy2YPl6JY8YWTawKo8OEtwiApT2vRlnONESgFMTtvpf9V+KN0wijK7p4Drfqs+38c79PbC5AqrVzkK+wnfvtB2sMaJFWLm9snbJO51zqp7nCJM2KFVdsuCrmgqfvDAamAsyzHIYyQFSW+/AC7uMD95h2v20T2e6R5KbEhMoGwMGEUacso8LoIVLN6Qo/YlzErHoXoTxXSOMJ+Hyxe26VPZz/X8Q2bLVWue3QIYQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"sv_length_f1\"\n        title=\"Structural variation calling f1-score\"\n        src=\"/ont-open-datasets/static/f00bf98e186472966218d2ca1be133f2/59415/sv_f1.png\"\n        srcset=\"/ont-open-datasets/static/f00bf98e186472966218d2ca1be133f2/12f09/sv_f1.png 148w,\n/ont-open-datasets/static/f00bf98e186472966218d2ca1be133f2/e4a3f/sv_f1.png 295w,\n/ont-open-datasets/static/f00bf98e186472966218d2ca1be133f2/59415/sv_f1.png 575w\"\n        sizes=\"(max-width: 575px) 100vw, 575px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","frontmatter":{"title":"Structural variation calling with GM24385","date":"December 01, 2020","description":"Structural variation calling with GM24385 (GIAB HG002) and the 2020.11 dataset"}}},"pageContext":{"slug":"/gm24385_2020.11_sv/","previous":{"fields":{"slug":"/gm24385_2020.11/"},"frontmatter":{"title":"November 2020 GM24385 Dataset Release"}},"next":null}},"staticQueryHashes":["1246554614","1462070832","2841359383"]}